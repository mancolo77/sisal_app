# üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: Hive Type Cast Exception

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**
```
E/flutter: [ERROR:flutter/runtime/dart_vm_initializer.cc(40)] 
Unhandled Exception: type 'Null' is not a subtype of type 'QuizSet' in type cast
E/flutter: #0 QuizAttemptAdapter.read (quiz_attempt.g.dart:28:26)
```

**–ü—Ä–∏—á–∏–Ω–∞**: –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è `quizSet` –≤ –º–æ–¥–µ–ª—å `QuizAttempt`, —Å—Ç–∞—Ä—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ Hive –Ω–µ —Å–æ–¥–µ—Ä–∂–∞–ª–∏ —ç—Ç–æ –ø–æ–ª–µ, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –æ—à–∏–±–∫–µ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø—Ä–æ—á–∏—Ç–∞—Ç—å `null` –∫–∞–∫ `QuizSet`.

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ**

### 1. **–°–¥–µ–ª–∞–ª–∏ –ø–æ–ª–µ `quizSet` –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º**
```dart
// –ë—ã–ª–æ:
@HiveField(8)
final QuizSet quizSet;

// –°—Ç–∞–ª–æ:
@HiveField(8)
final QuizSet? quizSet;
```

### 2. **–û–±–Ω–æ–≤–∏–ª–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä**
```dart
// –ë—ã–ª–æ:
const QuizAttempt({
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
  required this.quizSet,
});

// –°—Ç–∞–ª–æ:
const QuizAttempt({
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
  this.quizSet, // –¢–µ–ø–µ—Ä—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ
});
```

### 3. **–î–æ–±–∞–≤–∏–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≥–µ—Ç—Ç–µ—Ä `quizSetSafe`**
```dart
/// Get QuizSet - either from stored value or create a fallback
QuizSet get quizSetSafe {
  if (quizSet != null) return quizSet!;
  
  // Create fallback QuizSet for old data
  return QuizSet(
    id: quizSetId,
    title: 'Quiz',
    section: SportSection.football, // Default section
    questionIds: answers.map((a) => a.questionId).toList(),
    isSystem: true,
    timePerQuestionSec: null,
    shuffleQuestions: false,
    shuffleOptions: false,
    createdAt: startedAt,
  );
}
```

### 4. **–û–±–Ω–æ–≤–∏–ª–∏ –≤—Å–µ –º–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**
–ó–∞–º–µ–Ω–∏–ª–∏ `attempt.quizSet` –Ω–∞ `attempt.quizSetSafe` –≤:
- `lib/ui/screens/history/history_screen.dart` (2 –º–µ—Å—Ç–∞)
- `lib/ui/screens/settings/settings_screen.dart` (1 –º–µ—Å—Ç–æ)
- `lib/ui/screens/results/results_screen.dart` (1 –º–µ—Å—Ç–æ)

### 5. **–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏ Hive –∞–¥–∞–ø—Ç–µ—Ä—ã**
```bash
flutter pub run build_runner build --delete-conflicting-outputs
```

## üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç**

### ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**
- –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ Hive
- –ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –ø–æ–ª–Ω—ã–º `QuizSet` –æ–±—ä–µ–∫—Ç–æ–º
- –ù–µ—Ç –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
- `quizSetSafe` –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π `QuizSet`
- Fallback —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –ù–µ—Ç null pointer exceptions

### ‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**
- –í—Å–µ —ç–∫—Ä–∞–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- Retry Quiz —Ä–∞–±–æ—Ç–∞–µ—Ç —Å fallback –¥–∞–Ω–Ω—ã–º–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏**

### **Hive Adapter –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```dart
// –°—Ç–∞—Ä—ã–π –∞–¥–∞–ø—Ç–µ—Ä (–≤—ã–∑—ã–≤–∞–ª –æ—à–∏–±–∫—É):
quizSet: fields[8] as QuizSet,

// –ù–æ–≤—ã–π –∞–¥–∞–ø—Ç–µ—Ä (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ):
quizSet: fields[8] as QuizSet?,
```

### **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è**: –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ —Ä—É—á–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
- **–ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–º–µ—Ç–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è**: –î–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –∏ –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–∞—é—Ç—Å—è

## üìä **–°—Ç–∞—Ç—É—Å**
- **–û—à–∏–±–∫–∞**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- **–ö–æ–º–ø–∏–ª—è—Ü–∏—è**: ‚úÖ –ë–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏! üöÄ
